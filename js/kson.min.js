!function(a,b){"use strict";function f(a){return"["==a[0]?a.slice(2):a}function g(a,b){return function(a,c){return null==a?a:"bool"==b?c?a&&1||0:a&&!0||!1:"date"==b?c?Math.round(a/1e3):new Date(1e3*a):"isodate"==b?c?a.toISOString():new Date(Date.parse(a)):a}}function h(a){function b(a){function b(a){return function(b,c){for(var d=a.length,e=c>0?0:d-1,f=c>0?d:-1;e!=f;e+=c)b=a[e](b,1!=c);return b}}function f(){for(var c,e,i,b=a.match(/(\\.|[^\|])+/g),f=[],h=b.length;h--;){for(c=b[h],e=c.match(/(\\.|[^:])+/g),c=e[0],e=e.slice(1),i=e.length;i--;)e[i]=e[i].replace("\\","");f.push((d[c]||g)(e,c))}return f}a&&!c[a]&&(e[a]=b(f(a)))}for(var h=a.meta=a.meta||[],i=a.fields.length;i--;)(h[i]=h[i]||0)&&b(f(h[i]))}function i(a,b,d,g){var h,i=f(b),j=e[i];if(j&&i!=b){for(a=a.slice(0),h=a.length;h--;)a[h]=j(a[h],g);return a}return null==a?a:c[i]?d(a,b,1):j?j(a,g):a}function j(a,b,d){var h,k,e=f(b),g=0,l=[];a instanceof Array&&"["!=b[0]&&(b="[]"+b),d||(l[0]=b),e==b&&(a=[a]);for(var m=c[e],n=m.fields,o=a.length,p=n.length;o>g;g++)for(k=a[g],h=0;p>h;h++)l.push(i(k[n[h]],m.meta[h],j,-1));return d?l:JSON.stringify(l)}function k(a,b,d){var h,l,e="string"==typeof a?JSON.parse(a):a,g=[],j=d?0:1;b||(b=e[0]);for(var m=f(b),n=c[m],o=n.fields,p=e.length,q=o.length;p>j;j+=q){for(h={},l=0;q>l;l++)h[o[l]]=i(e[j+l],n.meta[l],k,1);if(b==m)return h;g.push(h)}return g}function l(a){if("string"==typeof a&&(a=k(a)),a instanceof Array)for(var b=a.length;b--;)l(a[b]);else c[a.id]=a,h(a)}var c={schema:{id:"schema",fields:["id","fields","meta"],meta:[0,"[]","[]"]}},d={"enum":function(a){for(var b=a.unshift(0),c={};b--;)c[a[b]]=b;return function(b,d){return d?c[b]||b:a[b]||b}},prefix:function(a){var b=new RegExp("^"+a[0]);return function(c,d){return d?c.replace(b,""):a[0]+c}},suffix:function(a){var b=new RegExp(a[0]+"$");return function(c,d){return d?c.replace(b,""):c+a[0]}}},e={};a.KSON=b.exports={coders:d,addSchema:l,parse:k,stringify:j}}(this,"undefined"==typeof module?{}:module);